<?xml version="1.0" encoding="utf-8"?>
<model version="NetLogo 7.0.0" snapToGrid="true">
  <code><![CDATA[globals [
  ; These variables give the layout of the view from top to bottom
  y-view-top                 ; y-coordinate at the top of the view (0.5)
  y-mRNA-top                 ; y-coordinate at the top of the mRNA area
  y-mRNA-bottom              ; y-coordinate at the bottom of the mRNA area
  y-TF-top                   ; y-coordinate at the top of the TF area
  y-TF-bottom                ; y-coordinate at the bottom of the TF area
  y-DNA                      ; y-coordinate of the DNA turtles
  y-view-bottom              ; y-coordinate at the bottom of the view (-0.5)

  ; These variables set the width of the plots that have "rolling" views of the recent data
  signal-rolling-plot-width    ; width in ticks of rolling signal plot
  TF-rolling-plot-width        ; width in ticks of rolling TF plot
  interval-rolling-plot-width  ; number of off intervals show in rolling signal plot

  ; This variable is used to implement the plot of off interval lengths
  ; The plot is updated only when completed-signal-off-length is not 0
  completed-signal-off-length  ; 0 if we have not just transitioned from an off to an on state
                               ; length (in ticks) of off state if we have just transitioned

  ; This variable is used to implement the plot of on interval lengths
  ; The plot is updated only when completed-signal-on-length is not 0
  completed-signal-on-length   ; 0 if we have not just transitioned from an on to an off state
                               ; length (in ticks) of off state if we have just transitioned
  signal-off-length-list       ; list of the lengths of each off period
  signal-on-length-list        ; list of the lengths of each on period
]

;; set trades lput trades-in-this-tick trades

; The signal indicates the overall state of the system ON or OFF
breed [ signals signal ]
; A DNA-segment is a visual representation of part of a larger stretch of coding DNA
breed [ DNA-segments DNA-segment ]
; An mRNA is a messenger RNA
breed [ mRNAs mRNA ]
; A TF is a Transcription Factor, a type of protein
breed [ TFs TF ]
; A TF-binding-site is a stretch of DNA to which a TF can attach
breed [ TF-binding-sites TF-binding-site ]

; A banner is a size 0 turtle used to display a properly positioned label for another turtle
breed [ banners banner ]
; A gene-label shows the name of a gene, e.g. GENE 0
breed [ gene-labels gene-label ]
; A gene-off-label displays the word OFF when a gene is bound by a TF
breed [ gene-off-labels gene-off-label ]
; The signal-label shows the word SIGNAL, indicating the location of the signal
breed [ signal-labels signal-label ]

; Each patch is identified with the gene it contains
patches-own             [
  DNA-gene-id                ; ID number of the patch's gene
  DNA-inhibited-by-gene-id   ; ID number of the gene that produces the TF that inhibits the patch's gene
  gene-inhibited?            ; Is this gene inhibited? true/false
]
mRNAs-own               [
  mRNA-gene-id               ; ID number of the gene that produced this mRNA
]
TFs-own                 [
  TF-gene-id                 ; ID number of the gene/mRNA that produced this TF
  TF-inhibits-gene-id        ; ID number of the gene inhibited by this TF
  TF-age                     ; Number of ticks since this TF was created. Currently for informational use only.
  TF-bound?                  ; Is this TF bound to a gene?  true/false
  TF-bound-to-signal?        ; Is this TF bound to the signal?  true/false
]
TF-binding-sites-own    [
  TF-binding-site-gene-id    ; ID number of the TF binding site's gene
]
signals-own             [
  signal-bound?              ; Is the signal bound? true/false
  signal-on?                 ; Is the signal on? true/false
  was-signal-on?             ; Was the signal on during the last tick? true/false
                             ; equals signal-on? for tick 0
  interval-start             ; tick on which the last interval started
  my-banner                  ; banner associated with the signal
]
gene-labels-own         [
  my-banner                  ; banner associated with the gene label
]
gene-off-labels-own     [
  my-banner                  ; banner associated with the gene off label
]
signal-labels-own       [
  my-banner                  ; banner associated with the signal
]

;-----------------------------------------------------------------------------------;
to setup
  clear-all
  reset-ticks

  set-default-shape mRNAs "mRNA"
  ; TFs start out unbound, but may later change shape
  set-default-shape TFs unbound-TF-shape

  ; Create a one-dimensional world with 3 patches
  resize-world 0 num-patches - 1 0 0
  set-patch-size 250

  initialize-layout
  initialize-patches
  initialize-TFs
  initialize-signal
  set signal-off-length-list []
  set signal-on-length-list []
end

to go

  ; TFs can bind with some probability
  bind-TFs

  ; TFs can move
  ; A TF that is in an inhibiting position stays in place
  ; Other TFs relocate randomly
  move-TFs

    ; TFs can unbind with some probability
  unbind-TFs

  ; mRNAs and TFs can degrade with some probability
  degrade-TFs
  degrade-mRNAs

  ; Each patch will produce transcription factors if the gene is not inhibited

  ; TF age is just for informational purposes
  ask TFs [set TF-age TF-age + 1]
  produce-mRNAs

  produce-TFs

  ; Determine if the signal is on.
  ; Set its color and ON/OFF sign appropriately.
  update-signal

  tick
end


;;;; Initialization Functions ;;;;

; Initialize constants for the layout
; The y coordinate for each patch goes from -0.5 at the bottom of the view to
;   0.5 at the top of the view.
; From top to bottom the variables below delimit:
;   the mRNA area
;   the TF area
;   the DNA area
to initialize-layout
  ; top of the view
  set y-view-top 0.5
  set y-view-bottom -0.5
  set y-mRNA-top y-view-top - 0.5 * mRNA-size
  set y-mRNA-bottom y-mRNA-top - 0.3 * mRNA-size
  set y-TF-top y-mRNA-bottom - 0.25 * (mRNA-size + TF-size)
  set y-DNA y-view-bottom + DNA-segment-size
  set y-TF-bottom y-DNA + 0.5 * TF-size
end

; The patches need to be initialize with color, some variables, and DNA for the gene.
to initialize-patches
  ; The patches have a variable indicated which TF they are inhibited by
  ; The value is the DNA-gene-id of the patch to the left. (with wrap)
  ask patches [
    set DNA-gene-id pxcor
    set pcolor patch-color DNA-gene-id
    set DNA-inhibited-by-gene-id get-TF-DNA-is-inhibited-by DNA-gene-id
    set gene-inhibited? false
    initialize-composite-DNA   ; create the DNA
    initialize-gene-label      ; create label for the DNA
    initialize-gene-off-label  ; create label that will indicate gene is inhibited
  ]
end

; I am a patch, initialize my DNA. It is composed of two binding sites and
; three DNA coding segments.
to initialize-composite-DNA ; patch procedure
  sprout-DNA-segments 1 [
    set shape "binding site"
    set xcor (DNA-x-offset  + DNA-gene-id) + 0.5  * DNA-segment-size
    set ycor y-DNA
    set size DNA-segment-size
    set heading 0
    set color yellow
  ]
  sprout-DNA-segments 1 [
    set shape "binding site"
    set xcor (DNA-x-offset  + DNA-gene-id) + 1.5 * DNA-segment-size
    set ycor y-DNA
    set size DNA-segment-size
    set heading 0
    set color black
  ]
  sprout-DNA-segments 1 [
    set shape one-of DNA-segment-shapes
    set xcor (DNA-x-offset  + DNA-gene-id) + 2.5 * DNA-segment-size
    set ycor  y-DNA
    set size DNA-segment-size
    set heading 0
  ]
  sprout-DNA-segments 1 [
    set shape one-of DNA-segment-shapes
    set xcor (DNA-x-offset + DNA-gene-id) + 3.5 * DNA-segment-size
    set ycor y-DNA
    set size DNA-segment-size
    set heading 0
  ]
  sprout-DNA-segments 1 [
    set shape one-of DNA-segment-shapes
    set xcor (DNA-x-offset + DNA-gene-id) + 4.5 * DNA-segment-size
    set ycor y-DNA
    set size DNA-segment-size
    set heading 0
  ]
end

; Initialize me, an mRNA. I start out in the top region. My color is slightly
; darker than my patch color. My id corresponds to that of my parent patch
to initialize-mRNA  ; turtle procedure
  set heading -45 + random 90
  set mRNA-gene-id DNA-gene-id
  set size mRNA-size
  let usable-mRNA-height y-mRNA-top - y-mRNA-bottom
  set xcor (mRNA-gene-id - 0.5 + 0.5 * mRNA-size) +
  (count-other-mRNAs-same-patch * 1.6 * mRNA-size) mod (1 - mRNA-size)
  set ycor y-mRNA-bottom + random-float usable-mRNA-height
  set color darken-color pcolor
end

; By default there are no initial TFs, however the user can set their number.
to initialize-TFs
  ask patches with [ DNA-gene-id = 0 ] [ create-initial-TFs initial-TF0s ]
  ask patches with [ DNA-gene-id = 1 ] [ create-initial-TFs initial-TF1s ]
  ask patches with [ DNA-gene-id = 2 ] [ create-initial-TFs initial-TF2s ]
end

; I am a patch. Create my initial TFs.
to create-initial-TFs [ initial-TFs ] ; patch procedure
  ; Create my TFs one at a time because their position depends on
  ; how many TFs of the same kind I already have
  foreach range initial-TFs [ sprout-TFs 1 [ initialize-TF ] ]
end

; I am a TF. Set my initial position and values. I start out in my home patch,
; facing right. My color is slightly darker than the home patch color. My
; TF-gene-id corresponding to my parent patch. I know the id of the gene I inhibit.
to initialize-TF ; turtle procedure
  set heading 0
  set TF-gene-id DNA-gene-id
  set TF-inhibits-gene-id get-DNA-TF-inhibits DNA-gene-id
  set TF-bound? false
  set TF-bound-to-signal? false
  set size TF-size
  set-TF-position
  set color darken-color pcolor
end

; I am a TF in a given patch. Set my position. Place me in the correct column.
; There are three columns, corresponding to the three kinds of TF.
; My x coordinate is random within the column. My y coordinate depends on the
; number of TFs of my kind on the patch.
to set-TF-position ; turtle procedure
  let col-position-width 1 / num-patches - ( 0.5 * TF-size )
  set xcor (get-patch-column-x DNA-gene-id) +
    (random-float col-position-width) - 0.5 *  col-position-width
  set ycor y-TF-top -
    (count-other-TFs-same-color-same-patch * 0.5 * TF-size) mod (y-TF-top - y-TF-bottom)
end

; The signal is the state of the system visible to the world. In the physical
; repressilator it is on a separate circular DNA. Here it is visualized in
; the lower right corner of the right most patch. If at least one TF from the
; right most gene binds the signal, it will be off. Otherwise the signal will be on.
to initialize-signal
  create-signals 1 [
    set size signal-size
    set shape "signal"
    setxy (max-pxcor + 0.5 - .75 * size) (y-view-bottom + size + .01)

    set heading 0
    set signal-bound? false
    set signal-on? true
    set was-signal-on? true
    set interval-start 0
    set completed-signal-off-length 0
    set completed-signal-on-length 0
    set color signal-on-color
    attach-banner-below "ON"
    initialize-signal-label
  ]
end

; I am a patch, initialize my gene label. The gene labels "GENE 0", "GENE 1",
; and "GENE 2" are displayed beneath the corresponding DNA.
to initialize-gene-label ; patch procedure
  sprout-gene-labels 1  [
    set size 0
    set label-color black
    attach-banner word "GENE " DNA-gene-id
    set xcor 0.5 * DNA-segment-size + DNA-gene-id
    set ycor y-view-bottom
  ]
end

; I am a patch, initialize my "OFF" label. When my DNA is inhibited (a TF is
; attached to the binding site) a white label "OFF" will be displayed. Otherwise
; the label will be hidden.
to initialize-gene-off-label  ; patch procedure
  sprout-gene-off-labels 1  [
    set size 0
    hide-turtle
    set label-color white
    attach-banner "OFF"
    set xcor 2.5 * DNA-segment-size + DNA-gene-id - 0.5
    set ycor y-view-bottom
  ]
end

; I am the signal, initialize my label "SIGNAL".
to initialize-signal-label ; turtle procedure
  hatch-signal-labels 1  [
    set size 0
    set label-color black
    set label "SIGNAL"
    set xcor (get-signal-xcor - 0.65 * signal-size)
    set ycor y-for-label-below-me
  ]
end

; I am a turtle. Report a y-coordinate below me, suitable for a label.
to-report y-for-label-below-me ; turtle procedure
  report [ ycor ] of myself - [ size ] of myself - 0.01
end

;;;; Action Procedures ;;;;

; mRNAs are produced once per tick if the corresponding DNA is not inhibited.
to produce-mRNAs
  ; no mRNAs will be produced if there is an inhibiting TF on the patch
  ; create them one at a time so they will spread out
  ask patches with [ not gene-inhibited? ] [
    foreach range n-mRNAs-produced [
      sprout-mRNAs 1 [ initialize-mRNA ]
    ]
  ]
end

; mRNAs will degrade (die) with some probability.
to degrade-mRNAs
  ask mRNAs [
    if random-float 1 < mRNA-decay-prob [ die ]
  ]
end

; TFs are produced once per tick by mRNAs.
to produce-TFs
  ask mRNAs [
    hatch-TFs n-TFs-produced [ initialize-TF ]
  ]
end

; TFs will degrade (die) with some probability.
to degrade-TFs
  ask TFs [
    if random-float 1 < TF-decay-prob [
      if TF-bound? [ unbind-TF ]
      if TF-bound-to-signal? [ unbind-TF-from-signal ]
      die
    ]
  ]
  update-gene-off-labels
end

; TFs can move randomly to any patch (or stay put) unless they are inhibiting DNA
; or the signal.
to move-TFs
  ask TFs with [ not TF-bound? and not TF-bound-to-signal? ]  [
    set xcor (xcor + random num-patches) set heading -45 + random 90
  ]
end

; Bind some TFs to DNA or the signal, if they are eligible and pass a probabilistic test
to bind-TFs
  ; Potentially inhibiting TFs will bind to DNA  with some probability.
  ; There is cooperativity - more TFs (up to max-TF-synergy TFs) increase the
  ; binding probability.
  ask TFs with [ TF-can-bind-gene-here? ] [
    ; coef is used to implement co-operativity.
    let coef 1 / (max list max-TF-synergy count-other-TFs-same-color-same-patch)
    if random-float 1 < TF-bind-prob ^ coef [ bind-TF ]
  ]
  ; if any TFs are bound, the off labels must become visible
  update-gene-off-labels

  ask TFs with [ TF-can-bind-signal? ] [
    if random-float 1 < signal-TF-bind-prob [ bind-TF-to-signal ]
  ]
end

; I am a TF that is ready to bind to DNA - bind me. I should have already
; passed the probabilistic test in bind-TFs.
to bind-TF ; turtle procedure

  ; initially:
  ;   TF should be unbound
  ;   gene (patch) should not be inhibited
  ;   TF should be on patch it can inhibit
  ; action:
  ;   set TF to be bound
  ;   set gene (patch) to be inhibited

  ; note - the binding test should already have be run, test in case
  if TF-can-bind-gene-here? [
    set TF-bound? true
    ask patch-here [ set gene-inhibited? true ]
    ; bound TFs have a different shape
    update-TF-shape
    ; the TF should sit in the binding site of the DNA
    set xcor (DNA-x-offset  + DNA-gene-id) + 1.5  * DNA-segment-size
    set ycor  y-DNA
    set heading 0
  ]
end

; I am a TF that is ready to bind to the signal - bind me. I should have
; already passed the probabilistic test in bind-TFs.
to bind-TF-to-signal ; turtle procedure
  ; initially:
  ;   TF should be unbound
  ;   signal should not be inhibited
  ; action:
  ;   set TF to be bound
  ;   set signal to be inhibited
  ; note - the binding test should already have be run, but just in case
  if TF-can-bind-signal? [
    set TF-bound-to-signal? true
    ask signals [ set signal-bound? true ]
    update-TF-shape
    set xcor get-signal-xcor
    set ycor get-signal-ycor
    set heading 0
  ]
end

; Unbind some TFs from DNA or the signal, if they are eligible and pass a
; probabilistic test.
to unbind-TFs
  ask TFs with [ TF-bound? ] [
    if random-float 1 < TF-unbind-prob [ unbind-TF ]
  ]
  ; if any TFs are unbound, the off labels must become invisible
  update-gene-off-labels

  ask TFs with [ TF-bound-to-signal? ] [
    if random-float 1 < signal-TF-unbind-prob [ unbind-TF-from-signal ]
  ]
end

; I am a TF that is ready to unbind from DNA - unbind me. I should have already
; passed the probabilistic test in unbind-TFs.
to unbind-TF ; turtle procedure
  if TF-bound? [
    set TF-bound? false
    ; set the gene (patch) to not inhibited
    ask patch-here [ set gene-inhibited? false ]
    update-TF-shape ; unbound TFs have a different shape
    set-TF-position ; return me to my TF area
  ]
end

; I am a TF that is ready to unbind from the signal - unbind me. I should have
; already passed the probabilistic test in unbind-TFs.
to unbind-TF-from-signal ; turtle procedure
  ; initially I should be bound
  ;  so set me to be unbound and set signal to not inhibited
  if TF-bound-to-signal? [
    set TF-bound-to-signal? false
    ask signals [ set signal-bound? false ]
    set-TF-position
    update-TF-shape
  ]
end

;;;; Banner Procedures ;;;;

; Banners are turtles used to allow control over the positioning of labels

; I am a turtle. Attach a banner to me. The banner label is centered horizontally
; relative to me. The banner is optionally placed below me.
to attach-banner-optionally-below [ the-text below? ] ; turtle procedure
  hatch-banners 1 [
    set size 0
    set label the-text
    set xcor [ xcor ] of myself + 0.4 * [ size ] of myself
    if below? [ set ycor [ ycor ] of myself - [ size ] of myself - 0.01 ]
    let me self
    if [ hidden? ] of myself [ hide-turtle ]
    ask myself [ set my-banner me ]
    create-link-from myself [
      tie
      hide-link
    ]
  ]
end

; I am a turtle. Attach a banner to me. The banner label is centered horizontally
; relative to me.
to attach-banner [ the-text ] ; turtle procedure
  attach-banner-optionally-below the-text false
end

; I am a turtle. Attach a banner to me. The banner label is centered horizontally
; relative to me and is below me.
to attach-banner-below [ the-text ] ; turtle procedure
  attach-banner-optionally-below the-text true
end

; I am a turtle with a banner and will make my label visible.
to show-turtle-and-banner ; turtle procedure
  show-turtle
  ask my-banner [ show-turtle ]
end

; I am a turtle with a banner and will make my label invisible.
to hide-turtle-and-banner ; turtle procedure
  hide-turtle
  ask my-banner [ hide-turtle ]
end

; hide or show the gene-off-labels of all patches
to update-gene-off-labels
  ask patches [
    ifelse gene-inhibited?
      [ ask gene-off-labels-here [ show-turtle-and-banner ] ]
      [ ask gene-off-labels-here [ hide-turtle-and-banner ] ]
  ]
end

;;;; Reporter Procedures ;;;;

; the "wrap" topology is implemented by doing computations mod num-patches

; Report the gene-id of the DNA (patch x coordinate) inhibited by a TF of a
; particular gene-id. It is the patch to the right with wrapping. The patch
; to the right of the rightmost patch is the leftmost patch.
to-report get-DNA-TF-inhibits [ local-TF-gene-id ]
  report (local-TF-gene-id + 1) mod num-patches
end

; Report the gene-id of the TF that inhibits the DNA of a particular patch.
; The TF originates from  the patch to the left with wrapping.
to-report get-TF-DNA-is-inhibited-by [ local-DNA-gene-id ]
  report (local-DNA-gene-id - 1) mod num-patches
end

; Report number of mRNAs on this patch other than me
to-report count-other-mRNAs-same-patch ; turtle procedure
  report count other mRNAs-here
end

; Report number of transcription factors on this patch other than me
to-report count-other-TFs-same-color-same-patch ; turtle procedure
  report count other TFs-here with [ TF-gene-id = [TF-gene-id] of myself ]
end

; Report whether I am a TF that can bind the gene of the patch I am on
to-report TF-can-bind-gene-here? ; turtle procedure
  ; I can't already be bound, no TF can be bound to the gene,
  ; and I need to be the right kind of TF.
  report (not TF-bound? and not gene-inhibited? and TF-can-inhibit-gene-here?)
end

; Report whether I am a TF that can bind the signal
to-report TF-can-bind-signal? ; turtle procedure
  ; The signal must be unbound, I am not attached to a binding site,
  ; and I come from the right patch.
  report (not is-signal-bound?) and
    (not TF-bound?) and TF-gene-id = signal-TF-gene-id
end

; Update the status and appearance of the signal. This should be done only once per tick
; at the end of the go cycle. Determine if the signal is on. Set the signal color and
; ON/OFF label appropriately.
; Keep track of intervals during which the signal is ON or OFF
to update-signal
  ask signals [
    ; save the previous signal state
    if ticks > 0 [ set was-signal-on?  signal-on? ]

    ; because an on signal can decay, and because a bound TF can unbind
    ; need to determine whether the signal should be on
    set signal-on? should-signal-be-on?

    ; This is an edge case
    if ticks = 0 [ set was-signal-on?  signal-on? ]

    ; set appropriate color
    set color  (
      ifelse-value signal-on?
        [ signal-on-color ]
        [ signal-off-color ]
    )
    ;set appropriate label
    ask my-banner [ set label (
      ifelse-value [ signal-on? ] of myself
        [ "ON" ]
        [ "OFF" ]
      )
    ]

    ; Keep track of the start and length of intervals

    ; These should always be zero, except at the end of an interval
    ; The plot is only updated when the value is positive
    set completed-signal-off-length 0
    set completed-signal-on-length 0

    ; Signal goes from ON to OFF - ON interval is completed
    if ( was-signal-on? = TRUE and is-signal-on? = FALSE) [
      set completed-signal-on-length ticks - interval-start
      set interval-start ticks
      ; add data to list
      set signal-on-length-list lput completed-signal-on-length signal-on-length-list
    ]

    ; Signal goes from OFF to ON - OF interval is completed
    if ( was-signal-on? = FALSE and is-signal-on? = TRUE) [
      set completed-signal-off-length ticks - interval-start
      set interval-start ticks
      ; add data to array
      set signal-off-length-list lput completed-signal-off-length signal-off-length-list
    ]
  ]
  update-plots
end

; Set me (TF) to the appropriate shape depending on whether I am unbound, bound to a gene,
; or bound to the signal.
to update-TF-shape ; turtle procedure
  ifelse not TF-bound? and not TF-bound-to-signal?  [ set shape unbound-TF-shape ]
    [ set shape ifelse-value TF-bound?
      [ bound-TF-shape ]
      [ bound-to-signal-TF-shape ]
    ]
end

; Can I (TF) inhibit the gene of the patch I am on
to-report TF-can-inhibit-gene-here?  ; turtle procedure
 ; inhibits if gene-id inhibited by my-TF is the DNA-gene-id of TF's patch
  report TF-inhibits-gene-id = DNA-gene-id
end

; On average 1 mRNA will be produced per tick.
to-report n-mRNAs-produced
  report random-poisson 1
end

; On average each mRNA will produce TFs-per-mRNA per tick.
to-report n-TFs-produced
  report random-poisson ( TFs-per-mRNA )
end

; Return the signal.
to-report the-signal
  ; There is only one in the AgentSet.
  report one-of signals
end

; Report whether the signal is bound.
to-report is-signal-bound?
  report [ signal-bound? ] of the-signal
end

; Report whether the signal is on.
to-report is-signal-on?
  report [ signal-on? ] of the-signal
end

; Report the x coordinate of the signal.
to-report get-signal-xcor
  report [ xcor ] of the-signal
end

; Report the y coordinate of the signal.
to-report get-signal-ycor
  report [ ycor ] of the-signal
end

; I am a signal. Report whether I should be on. The signal will be on when no TF
; is bound to it. After a TF binds the signal there is a fixed chance that it will turn
; off per tick with TF bound.
to-report should-signal-be-on? ; turtle procedure
  ; the signal stay on rate when the signal is bound is 1 - signal-decay-prob
  report (not is-signal-bound?) or (signal-on? and random-float 1 < 1 - signal-decay-prob)
end

; Report the x coordinate of the column (0, 1 or 2)
; in my local patch (if I am a turtle) or in me (if I am a patch).
to-report get-patch-column-x [ column-num ] ; turtle or patch procedure
  ; column numbers go from 0 to num-patches - 1
  report pxcor + ((column-num - 1) / num-patches)
end

; Report the color of the patch with the given index (0, 1, or 2).
to-report patch-color [ the-gene-id ]
  report item the-gene-id patch-colors
end

; Report a color slightly darker than the given color.
; The color must not be at the black end of a color range, that is its units digit must
; must be greater than greater than 1.
to-report darken-color [ the-color ]
  ; Subtract a small amount to make a color darker.
  report the-color - 0.8
end

;;;; Reporters for Display, Layout, Etc. ;;;;

; These are used as replacements for global variables.
to-report num-patches
  report 3
end

to-report DNA-segment-size
  report 0.1
end

to-report mRNA-size
  report 0.15
end

to-report TF-size
  report 0.15
end

to-report bound-TF-size
  report 0.1
end

to-report signal-size
  report 0.1
end

to-report gene-off-label-size
  report 0.1
end

; Reports a list of different DNA segment shapes that can be incorporated
; into a composite piece of DNA
to-report DNA-segment-shapes
  report (list "DNA 1" "DNA 2" "DNA 3" "DNA 4")
end

to-report bound-TF-shape
  report "Transcription Factor bound"
end

to-report unbound-TF-shape
  report "Transcription Factor"
end

to-report bound-to-signal-TF-shape
  report "Transcription Factor bound"
end

to-report signal-on-color
  report lime
end

to-report patch-colors
  report (list 24.4 115.6 75)
end

to-report signal-off-color
  report black
end

to-report DNA-x-offset
  report -0.5 + 0.5 * DNA-segment-size
end

to-report signal-TF-gene-id
  report 2
end

; functions to evaluate the on-off characteristics of a model run
; could easily add: max median standard-deviation modes

to-report mean-on-duration
  report ifelse-value length signal-on-length-list > 0
  [ mean signal-on-length-list ] [ 0 ]
end

to-report mean-off-duration
  report ifelse-value length signal-off-length-list > 0
  [ mean signal-off-length-list ] [ 0 ]
end

to-report harmonic-mean [ val1 val2 ]
  let the-sum val1 + val2
    report ifelse-value the-sum  > 0
  [ (2 * val1 * val2) / the-sum ] [ 0 ]
end

to-report on-off-harmonic-mean
    report harmonic-mean mean-on-duration mean-off-duration
end

; The harmonic mean is not an adequate objective function
; Each mean is at least 1.0, so a result in which the signal is on for
; very long periods, and off for one tick would score well.
; Therefore both means need to hit a minimum value.
; Also the mean can be misleading if there are only a few items on the list,
; and one is much larger than the others
to-report on-off-optim-fcn22
  if length signal-off-length-list < 20 [ report 0 ]
  let v-on mean-on-duration
  let v-off mean-off-duration
  ; require each value be at least 2.0
  if (v-on < 2.0 or v-off < 2.0) [ report min list v-off v-on ]
  ; don't count values beyond 50
  set v-on min list v-on 50
  set v-off min list v-off 50
  report harmonic-mean mean-on-duration mean-off-duration
end


to-report on-off-optim-fcn1
  let v-on mean-on-duration
  let v-off mean-off-duration
  ; require each value be at least 2.0
  if (v-on < 2.0 or v-off < 2.0) [ report 0.0 ]
  ; don't count values beyond 50
  set v-on min list v-on 50
  set v-off min list v-off 50
  report harmonic-mean mean-on-duration mean-off-duration
end


; Copyright 2020 Uri Wilensky.
; See Info tab for full copyright and license.]]></code>
  <widgets>
    <view x="420" maxPycor="0" updateMode="1" wrappingAllowedX="true" y="10" frameRate="30.0" minPycor="0" height="259" showTickCounter="true" patchSize="250.0" fontSize="10" wrappingAllowedY="true" width="758" tickCounterLabel="ticks" maxPxcor="2" minPxcor="0"></view>
    <button x="10" y="70" height="33" disableUntilTicks="false" forever="false" kind="Observer" width="72">setup</button>
    <button x="105" y="70" height="33" disableUntilTicks="true" forever="true" kind="Observer" width="75" display="go">go</button>
    <slider oldSize="true" x="10" step=".005" y="200" height="33" min="0" direction="Horizontal" max="1" default="0.1" variable="TF-decay-prob" width="185" display="TF-decay-prob"></slider>
    <slider oldSize="true" x="10" step=".005" y="160" height="33" min="0" direction="Horizontal" max="1" default="0.355" variable="TF-unbind-prob" width="185" display="TF-unbind-prob"></slider>
    <plot oldSize="true" x="540" yMax="1.0" yAxis="On = 1, 0 = Off" y="285" xMin="0.0" height="200" legend="false" xMax="500.0" autoplot="false" yMin="0.0" width="620" xAxis="Time" display="Recent Signal Pattern">
      <setup>set signal-rolling-plot-width 500
set-plot-x-range  0 signal-rolling-plot-width
</setup>
      <update><![CDATA[if ticks > signal-rolling-plot-width [
  ; scroll the range of the plot so only
  ; the last signal-rolling-plot-width ticks are visible
  set-plot-x-range (ticks - signal-rolling-plot-width) ticks
]]]></update>
      <pen color="-16777216" legend="true" interval="1.0" mode="0" display="default">
        <setup></setup>
        <update><![CDATA[if ticks > 0 [
ifelse is-signal-on? [ plotxy ticks 1 ] [ plotxy ticks 0 ]
]
]]></update>
      </pen>
    </plot>
    <slider oldSize="true" x="10" step=".005" y="120" height="33" min="0" direction="Horizontal" max="1" default="0.975" variable="TF-bind-prob" width="185" display="TF-bind-prob"></slider>
    <monitor oldSize="true" x="75" precision="17" y="310" height="45" fontSize="11" width="85" display="Num mRNA 0">count mRNAs with [ mRNA-gene-id = 0 ]</monitor>
    <monitor oldSize="true" x="180" precision="17" y="310" height="45" fontSize="11" width="83" display="Num mRNA 1">count mRNAs with [ mRNA-gene-id = 1 ]</monitor>
    <monitor oldSize="true" x="280" precision="17" y="310" height="45" fontSize="11" width="83" display="Num mRNA 2">count mRNAs with [ mRNA-gene-id = 2 ]</monitor>
    <slider oldSize="true" x="210" step=".005" y="120" height="33" min="0" direction="Horizontal" max="1" default="0.75" variable="signal-TF-bind-prob" width="200" display="signal-TF-bind-prob"></slider>
    <slider oldSize="true" x="210" step=".005" y="160" height="33" min="0" direction="Horizontal" max="1" default="0.1" variable="signal-TF-unbind-prob" width="200" display="signal-TF-unbind-prob"></slider>
    <slider oldSize="true" x="210" step=".005" y="200" height="33" min="0" direction="Horizontal" max="1" default="0.2" variable="signal-decay-prob" width="200" display="signal-decay-prob"></slider>
    <slider oldSize="true" x="10" step=".005" y="240" height="33" min="0" direction="Horizontal" max="1" default="0.25" variable="mRNA-decay-prob" width="150" display="mRNA-decay-prob"></slider>
    <plot oldSize="true" x="540" yMax="20.0" yAxis="TF Count" y="505" xMin="0.0" height="205" legend="true" xMax="100.0" autoplot="true" yMin="0.0" width="620" xAxis="Time" display="Recent TF Counts">
      <setup>set tf-rolling-plot-width 100
set-plot-x-range  0 tf-rolling-plot-width</setup>
      <update><![CDATA[
if ticks > tf-rolling-plot-width [
  ; scroll the range of the plot so only
  ; the last tf-rolling-plot-width ticks are visible\n
  set-plot-x-range (ticks - tf-rolling-plot-width) ticks
]]]></update>
      <pen color="-2269166" legend="true" interval="1.0" mode="0" display="TF Gene 0">
        <setup></setup>
        <update>plotxy ticks (count TFs with [ TF-gene-id = 0 ]) </update>
      </pen>
      <pen color="-7773779" legend="true" interval="1.0" mode="0" display="TF Gene 1">
        <setup></setup>
        <update>plotxy ticks (count TFs with [ TF-gene-id = 1 ])</update>
      </pen>
      <pen color="-14835848" legend="true" interval="1.0" mode="0" display="TF Gene 2">
        <setup></setup>
        <update>plotxy ticks (count TFs with [ TF-gene-id = 2 ])</update>
      </pen>
    </plot>
    <note x="180" y="290" height="18" backgroundDark="0" textColorLight="-16777216" backgroundLight="0" fontSize="12" width="90">mRNA Counts</note>
    <button x="205" y="70" height="33" disableUntilTicks="true" forever="false" kind="Observer" width="105" display="go-once">go</button>
    <slider oldSize="true" x="10" step="10" y="20" height="33" min="0" direction="Horizontal" max="200" default="0.0" variable="initial-TF0s" width="105" display="initial-TF0s"></slider>
    <slider oldSize="true" x="135" step="10" y="20" height="33" min="0" direction="Horizontal" max="200" default="0.0" variable="initial-TF1s" width="105" display="initial-TF1s"></slider>
    <slider oldSize="true" x="255" step="10" y="20" height="33" min="0" direction="Horizontal" max="200" default="0.0" variable="initial-TF2s" width="105" display="initial-TF2s"></slider>
    <slider oldSize="true" x="290" step="1" y="240" height="33" min="0" direction="Horizontal" max="4" default="4.0" variable="max-TF-synergy" width="120" display="max-TF-synergy"></slider>
    <slider oldSize="true" x="165" step="1" y="240" height="33" min="0" direction="Horizontal" max="10" default="2.0" variable="TFs-per-mRNA" width="120" display="TFs-per-mRNA"></slider>
    <plot oldSize="true" x="15" yMax="3.0" y="370" xMin="0.0" height="165" legend="false" xMax="100.0" autoplot="true" yMin="0.0" width="440" display="Time Between On Signals">
      <setup>set interval-rolling-plot-width 200
set-plot-x-range  0 interval-rolling-plot-width
set-plot-pen-mode 2</setup>
      <update><![CDATA[if FALSE and ticks > interval-rolling-plot-width [
  ; scroll the range of the plot so only
  ; the last interval-rolling-plot-width ticks are visible\n
  set-plot-x-range (ticks - interval-rolling-plot-width) ticks
]]]></update>
      <pen color="-16777216" legend="true" interval="1.0" mode="0" display="default">
        <setup></setup>
        <update><![CDATA[if completed-signal-off-length > 0 [
   plot completed-signal-off-length
]]]></update>
      </pen>
    </plot>
    <plot oldSize="true" x="10" yMax="3.0" y="550" xMin="0.0" height="165" legend="false" xMax="100.0" autoplot="true" yMin="0.0" width="440" display="Duration of On Signals">
      <setup>set interval-rolling-plot-width 200
set-plot-x-range  0 interval-rolling-plot-width
set-plot-pen-mode 2</setup>
      <update><![CDATA[if FALSE and ticks > interval-rolling-plot-width [
  ; scroll the range of the plot so only
  ; the last interval-rolling-plot-width ticks are visible\n
  set-plot-x-range (ticks - interval-rolling-plot-width) ticks
]]]></update>
      <pen color="-16777216" legend="true" interval="1.0" mode="0" display="default">
        <setup></setup>
        <update><![CDATA[if completed-signal-on-length > 0 [
   plot completed-signal-on-length
]]]></update>
      </pen>
    </plot>
  </widgets>
  <info><![CDATA[## WHAT IS IT?

This is a NetLogo model of one of the first notable constructs in synthetic biology: an oscillatory network of transcriptional regulators called a **repressilator**. Three sets of components (DNA, mRNA and proteins called transcription factors) each follow a simple set of rules, resulting in a signal being turned on and off.

For more information see [Wikipedia Repressilator](https://en.wikipedia.org/wiki/Repressilator)

The repressilator was a proof of concept that artificial biological constructs could behave reliably enough to mimic the behavior of electrical circuits. Although the repressilator did not have a practical application it helped lead the way toward more practical goals, such as biological circuits that could count and turn on or off after a fixed period of time. The hope is that such components can contribute to drug delivery, nano-construction, and other fields.

The repressilator has three genes, each of which produces a messenger RNA (mRNA) that produces a protein called a transcription factor (TF). What makes the system interesting is that the proteins can inhibit one of the other genes, and that they do so in a non-transitive way, analogous to the outcomes in the game Rock, Paper, Scissors - none of the actors dominates the other two.

## HOW IT WORKS

Call the three genes Gene 0, Gene 1 and Gene 2. The genes are DNA that includes a binding site to which an appropriate transcription factor can attach, and a coding section that gives the sequence of the mRNA. The corresponding mRNAs are mRNA 0, mRNA 1 and mRNA 2. The mRNAs produce corresponding transcription factors (TFs): TF 0, TF 1 and TF 2. The TFs inhibit genes from producing mRNA as follows:

* TF 0 inhibits Gene 1
* TF 1 inhibits Gene 2
* TF 2 inhibits Gene 0.

The inhibition can happen only if the TF is in the patch of the gene it inhibits, and even then binding has only a certain probability of succeeding. Biologically this corresponds to a transcription factor being near enough to the binding site of a gene's DNA to bind to it. Other events, such as whether an mRNA or a TF will decay (become non-functional and be broken down for "parts") or which gene a TF will move to are also governed by random factors.

From the perspective of the different types of agents, the rules for one tick are as follows (the process is cyclical):

* I am a TF,
    - If I am bound, I become unbound with some probability
    - I decay with some probability
* I am an mRNA, I decay with some probability
* I am coding DNA (a gene), is a TF bound to me?
    - If yes, do nothing
    - If no, I produce TFs-per-mRNA mRNAs (on average)
* I am an mRNA, I produce a set number of TFs (on average)
* I am a TF,
    - If I am on the patch of an unbound gene I can inhibit, I bind to the gene with some probability
        - If synergy is enabled and I am accompanied by TFs of my kind my probability of binding can increase.
    - If I am not bound, I move with equal probability to one of the patches (including my current patch)

### The Signal
The description above left out one element of the system - the signal. The signal represents the state of the system visible to the outside world.

The biological repressilator consists of tiny loops of DNA inside of _E. coli_ bacteria, which are themselves invisible to the naked eye. The bacteria are visible through a microscope, but the DNA is not. The visible output of the system is the glow of a fluorescent green protein as filmed through a microscope. The DNA encoding this protein is on a separate loop of DNA, although, in this NetLogo model, it is visualized in the lower right corner of the view.

A few rule updates are needed to add the behavior of the signal to the system:

* I am the signal, is a TF bound to me?
    - If yes, I become invisible with some probability
    - If no, I am visible

* I am an unbound TF 0 and the signal is unbound
    - I bind to the signal with some probability

## HOW TO USE IT

This model is visually complex, but easy to start using. Push the SETUP button to create three patches, each of which contains a gene. The rightmost patch also contains the signal. Push the GO button, and the action starts.

### The View
The model world consists of three patches along the x axis, with wrapping. It represents a system consisting of a piece of circular DNA with three genes, as well as associated  mRNA and TFs plus the signal. The model is one dimensional. The layout within each patch uses the vertical dimension for visualization of important agents in the model.

#### The mRNA
mRNAs are shown at the top of the view. The model does not represent the physical processes by which mRNAs are created by transcription from DNA, or translated into proteins such as TFs. See the _DNA Protein Synthesis_ and _GenEvo 1 Genetic Switch_ models for an illustration of these processes.

#### The Genes
The DNA for each gene appears near the bottom of the view. It has two binding sites, one of which can become occupied by a TF. The DNA also has a visual indicator of the coding sequence. The gene number is visible below the DNA. When the binding site is occupied, a label "OFF" become visible.

#### The Transcription Factors (TFs)
The TF area is located below the mRNA area. Each TF has a color that is a bit darker than the color of the patch containing the gene that coded for it. Each TF is located in the patch of the gene it is near, and with which it can potentially interact. Orientation and position are used to visually distinguish individual TFs of each type, but this does not reflect differences in access to the binding site.

#### The DNA
Each patch shows a portion of the DNA associated with it. The DNA appears near the bottom of the view. It has two binding sites, one of which can become occupied by a TF. When the binding site is occupied, the gene cannot produce mRNA and an "OFF" label becomes visible. The DNA also has a visual representation of the sequence of bases A, C, G and T coding for the mRNA. The gene number is visible below the DNA.

#### The Signal
The signal is the state of the system visible to the world. It is visualized in the lower right corner of the right-most patch. Conceptually it is physically separate from the rest of the DNA. The signal is on by default. It has a TF binding site. When a TF is bound, the signal will decay and become "OFF".

### Monitors
The three mRNA COUNTS Monitors beneath the view show the number of mRNAs of each type.

### Plots

The _Recent TF Counts_ Plot shows the number of TFs of each type over the last 500 ticks.
This can help give insight into the relationship between the TFs. When the number of one type of TF decreases, what happens to the other ones? How regular are the maxima and the minima of each colored line. The patterns are an emergent behavior of the TF populations, they are not build directly into a TF agent's rules.

The _Recent Signal Pattern_ Plot indicates whether the signal was on or off during each of the last 100 ticks.

The _Time_Between_On_Signals_ Plot shows the length of each time stretch during which the signal is off.

The _Duration_Of_On_Signals_ Plot shows the length of each time stretch during which the signal is on.

### The Sliders
The sliders represent physical characteristics of the biological components in the model.

#### Decay Sliders
Each decay slider gives the probability per tick that the corresponding entity will decay. A decay rate of 0 means the entity will exist forever. A decay rate of 1 means the entity will live for only one tick. Experiment with the extremes, as well as rates in between. Note that the performance of the system will degrade if the total number of TFs and mRNAs becomes too large.

**MRNA-DECAY-PROB**: The probability per tick that an individual mRNA will die.
**TF-DECAY-PROB**: The probability per tick that an individual TF will die.
**SIGNAL-DECAY-PROB**: The probability per tick that the an unbound ON signal will turn off.

#### Binding Sliders
Each binding slider gives the probability per tick that a TF will will bind to an accessible target (DNA binding-site or the signal). A binding rate of 0 means the entity will never bind. A binding rate of 1 means the entity will always bind an accessible target.

**TF-BIND-PROB**: The probability per tick that an individual TF will attach to the DNA binding site if it is in the patch of a gene it inhibits.
**SIGNAL-TF-BIND-PROB**: The probability per tick that an individual signal-inhibiting TF (TF 2) will bind to the signal if it is in the signal's patch.

#### Unbinding Sliders
Each unbinding slider gives the probability per tick that a bound TF will will unbind from its target. A unbinding rate of 0 means the entity will never unbind. A unbinding rate of 1 means the entity will always unbind from its target after one tick.

**TF-UNBIND-PROB**: The probability per tick that an individual DNA-bound TF will unbind.
**SIGNAL-TF-UNBIND-PROB**: The probability per tick that an individual signal-bound TF will unbind.

#### Input Widgets

**INITIAL-TF0**, **INITIAL-TF1**, **INITIAL-TF2**: These control the initial number of TFs for each of the three types.
**N-TFs-PER-mRNA**: The number of TFs that an mRNA will produce per tick on average.
**MAX-TF-SYNERGY**: In biology TFs competing for a target can cooperate, increasing the probability that one of them will bind, a phenomenon called synergy. This variable sets a limit beyond which additional TFs do not affect binding probability. If MAX-TF-SYNERGY is 1 there is no synergy. The result of synergy depends on the binding probability  TF-BIND-PROB or SIGNAL-TF-BIND-PROB.

## THINGS TO NOTICE

You might begin by getting an overall impression of the action in the view. The most prominent agents are the transcription factors (TFs). With each tick some are born and some die. Some stay in the same patch, and others relocate. Some may bind to a gene or the signal, and some may unbind. Each TF's behavior is guided by the rules given in HOW IT WORKS, but its specific action at any moment depends on probabilistic outcomes - it is stochastic.

Do you notice any patterns in the overall numbers of the TFs of each color? For example what happens when there is a build-up of turquoise TFs? Does a particular color of TF decrease in numbers next?

What connection can you observe between the number of mRNAs of each type and the number of corresponding TFs?

## THINGS TO TRY

By default, the simulation starts with no TFs. What happens if you start with TFs of one kind only? Do the other TFs eventually reach comparable levels?

BehaviorSpace can be used to systematically explore the effect of the variables. Which variables change the behavior most dramatically? Which variables increase or decrease the the interval between times the signal is on? Which variables increase the number of mRNAs or TFs? Can you find any states in which the signal is always on or always off?

## WHY ONE DIMENSIONAL?

There are advantages and disadvantages to having a one-dimensional model.

The main idea behind making the model one dimensional is to place the emphasis on how parameters such as binding and unbinding rates, synergy between TFs, and rate of mRNA production affect the rise and fall of different TF populations, and the intervals during which the signal is on and off. A potential disadvantage is that a two-dimensional model could be more realistic in a way that makes a difference.

The goal of a two-dimensional model would be that one could simulate the diffusion of TFs throughout the space. Synergy and binding could then be based on distance of TFs from the binding site. A potential problem with this type of modeling is that the time scale of the nano-movements is incredibly smaller than time scale of degradation of TFs and mRNAs. For example, TFs could wind up largely degrading before ever binding to a target.

## EXTENDING THE MODEL

  * Allow each of the three types of TF to have its own decay, binding and unbinding properties.
  * Allow each of the three types of mRNA to have its own decay and TF production properties.
  * Make the model two-dimensional - with patches in the y direction as well. The locations of the mRNA and TFs would then be physically meaningful. How would you handle the signal?
  * Display the age distribution of the TFs (collectively or by type.) Each TF has a TF-age property which equals the number of ticks for which it has existed. What is the shape of this distribution?
  * Instead of using a decay rate - a fixed probability of decay occurring in a fixed time period, one can characterize decay in terms of a half life - the time it takes for half of the items to die or transform. For example, Plutonium-239 has a half-life of 24,110 years. Convert decay rates to half-lives. Does this help you think about the effect of changing decay rates? What about other rates? The action of medicinal drugs is typically characterized by a half-life.

## NETLOGO FEATURES

An unusual feature of this model is that there is only one dimension of patches. The two-dimensional layout of each patch is computed using the patch's coordinate range , as well as information about the size of each breed of turtle. The x coordinates of `patch i 0` range from `i - 0.5` to `i + 0.5`  and y coordinates range from -0.5 to 0.5. The circularity of the topology is maintained through the use of the mod function. Since there are three patches, the patch to the right of `patch i 0` is `patch ((i + 1) mod 3) 0`. For example, the right-most patch is `patch 2 0`. The patch to its right is `patch (3 mod 3) 0`, which is `patch 0 0`, the left-most patch.

To control the placement of labels, this model makes use extra turtles called banners. ( See the Label Position Example model) NetLogo right justifies the position of a label in the lower right corner of the turtle’s bounding box. A banner is a turtle of size zero that carries the desired label. The x and y coordinates of the banner must be appropriately calculated relative to the size and position of the turtle that is actually being labeled.

## RELATED MODELS

* DNA Protein Synthesis
* GenEvo 1 - Genetic Switch
* Label Position Example
* Rock Paper Scissors

## CREDITS AND REFERENCES

Elowitz, M. B., & Leibler, S. (2000). A synthetic oscillatory network of transcriptional regulators. Nature, 403(6767), 335–338. 10.1038/35002125.

## HOW TO CITE

If you mention this model or the NetLogo software in a publication, we ask that you include the citations below.

For the model itself:

* Brandes, A. and Wilensky, U. (2020).  NetLogo Repressilator 1D model.  http://ccl.northwestern.edu/netlogo/models/Repressilator1D.  Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.

Please cite the NetLogo software as:

* Wilensky, U. (1999). NetLogo. http://ccl.northwestern.edu/netlogo/. Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.

## COPYRIGHT AND LICENSE

Copyright 2020 Uri Wilensky.

![CC BY-NC-SA 3.0](http://ccl.northwestern.edu/images/creativecommons/byncsa.png)

This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 3.0 License.  To view a copy of this license, visit https://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to Creative Commons, 559 Nathan Abbott Way, Stanford, California 94305, USA.

Commercial licenses are also available. To inquire about commercial licenses, please contact netlogo-commercial-admin@ccl.northwestern.edu.

<!-- 2020 Cite: Brandes, A. -->]]></info>
  <turtleShapes>
    <shape name="default" rotatable="true" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="5"></point>
        <point x="40" y="250"></point>
        <point x="150" y="205"></point>
        <point x="260" y="250"></point>
      </polygon>
    </shape>
    <shape name="airplane" rotatable="true" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="0"></point>
        <point x="135" y="15"></point>
        <point x="120" y="60"></point>
        <point x="120" y="105"></point>
        <point x="15" y="165"></point>
        <point x="15" y="195"></point>
        <point x="120" y="180"></point>
        <point x="135" y="240"></point>
        <point x="105" y="270"></point>
        <point x="120" y="285"></point>
        <point x="150" y="270"></point>
        <point x="180" y="285"></point>
        <point x="210" y="270"></point>
        <point x="165" y="240"></point>
        <point x="180" y="180"></point>
        <point x="285" y="195"></point>
        <point x="285" y="165"></point>
        <point x="180" y="105"></point>
        <point x="180" y="60"></point>
        <point x="165" y="15"></point>
      </polygon>
    </shape>
    <shape name="arrow" rotatable="true" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="0"></point>
        <point x="0" y="150"></point>
        <point x="105" y="150"></point>
        <point x="105" y="293"></point>
        <point x="195" y="293"></point>
        <point x="195" y="150"></point>
        <point x="300" y="150"></point>
      </polygon>
    </shape>
    <shape name="binding site" rotatable="true" editableColorIndex="6">
      <rectangle endX="75" startY="150" marked="true" color="751909887" endY="180" startX="0" filled="true"></rectangle>
      <rectangle endX="180" startY="150" marked="true" color="751909887" endY="180" startX="120" filled="true"></rectangle>
      <rectangle endX="300" startY="150" marked="true" color="751909887" endY="180" startX="225" filled="true"></rectangle>
      <rectangle endX="300" startY="180" marked="true" color="751909887" endY="195" startX="0" filled="true"></rectangle>
    </shape>
    <shape name="box" rotatable="false" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="285"></point>
        <point x="285" y="225"></point>
        <point x="285" y="75"></point>
        <point x="150" y="135"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="135"></point>
        <point x="15" y="75"></point>
        <point x="150" y="15"></point>
        <point x="285" y="75"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="15" y="75"></point>
        <point x="15" y="225"></point>
        <point x="150" y="285"></point>
        <point x="150" y="135"></point>
      </polygon>
      <line endX="150" startY="285" marked="false" color="255" endY="135" startX="150"></line>
      <line endX="15" startY="135" marked="false" color="255" endY="75" startX="150"></line>
      <line endX="285" startY="135" marked="false" color="255" endY="75" startX="150"></line>
    </shape>
    <shape name="bug" rotatable="true" editableColorIndex="0">
      <circle x="96" y="182" marked="true" color="-1920102913" diameter="108" filled="true"></circle>
      <circle x="110" y="127" marked="true" color="-1920102913" diameter="80" filled="true"></circle>
      <circle x="110" y="75" marked="true" color="-1920102913" diameter="80" filled="true"></circle>
      <line endX="80" startY="100" marked="true" color="-1920102913" endY="30" startX="150"></line>
      <line endX="220" startY="100" marked="true" color="-1920102913" endY="30" startX="150"></line>
    </shape>
    <shape name="butterfly" rotatable="true" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="165"></point>
        <point x="209" y="199"></point>
        <point x="225" y="225"></point>
        <point x="225" y="255"></point>
        <point x="195" y="270"></point>
        <point x="165" y="255"></point>
        <point x="150" y="240"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="165"></point>
        <point x="89" y="198"></point>
        <point x="75" y="225"></point>
        <point x="75" y="255"></point>
        <point x="105" y="270"></point>
        <point x="135" y="255"></point>
        <point x="150" y="240"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="139" y="148"></point>
        <point x="100" y="105"></point>
        <point x="55" y="90"></point>
        <point x="25" y="90"></point>
        <point x="10" y="105"></point>
        <point x="10" y="135"></point>
        <point x="25" y="180"></point>
        <point x="40" y="195"></point>
        <point x="85" y="194"></point>
        <point x="139" y="163"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="162" y="150"></point>
        <point x="200" y="105"></point>
        <point x="245" y="90"></point>
        <point x="275" y="90"></point>
        <point x="290" y="105"></point>
        <point x="290" y="135"></point>
        <point x="275" y="180"></point>
        <point x="260" y="195"></point>
        <point x="215" y="195"></point>
        <point x="162" y="165"></point>
      </polygon>
      <polygon color="255" filled="true" marked="false">
        <point x="150" y="255"></point>
        <point x="135" y="225"></point>
        <point x="120" y="150"></point>
        <point x="135" y="120"></point>
        <point x="150" y="105"></point>
        <point x="165" y="120"></point>
        <point x="180" y="150"></point>
        <point x="165" y="225"></point>
      </polygon>
      <circle x="135" y="90" marked="false" color="255" diameter="30" filled="true"></circle>
      <line endX="195" startY="105" marked="false" color="255" endY="60" startX="150"></line>
      <line endX="105" startY="105" marked="false" color="255" endY="60" startX="150"></line>
    </shape>
    <shape name="car" rotatable="false" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="300" y="180"></point>
        <point x="279" y="164"></point>
        <point x="261" y="144"></point>
        <point x="240" y="135"></point>
        <point x="226" y="132"></point>
        <point x="213" y="106"></point>
        <point x="203" y="84"></point>
        <point x="185" y="63"></point>
        <point x="159" y="50"></point>
        <point x="135" y="50"></point>
        <point x="75" y="60"></point>
        <point x="0" y="150"></point>
        <point x="0" y="165"></point>
        <point x="0" y="225"></point>
        <point x="300" y="225"></point>
        <point x="300" y="180"></point>
      </polygon>
      <circle x="180" y="180" marked="false" color="255" diameter="90" filled="true"></circle>
      <circle x="30" y="180" marked="false" color="255" diameter="90" filled="true"></circle>
      <polygon color="255" filled="true" marked="false">
        <point x="162" y="80"></point>
        <point x="132" y="78"></point>
        <point x="134" y="135"></point>
        <point x="209" y="135"></point>
        <point x="194" y="105"></point>
        <point x="189" y="96"></point>
        <point x="180" y="89"></point>
      </polygon>
      <circle x="47" y="195" marked="true" color="-1920102913" diameter="58" filled="true"></circle>
      <circle x="195" y="195" marked="true" color="-1920102913" diameter="58" filled="true"></circle>
    </shape>
    <shape name="circle" rotatable="false" editableColorIndex="0">
      <circle x="0" y="0" marked="true" color="-1920102913" diameter="300" filled="true"></circle>
    </shape>
    <shape name="circle 2" rotatable="false" editableColorIndex="0">
      <circle x="0" y="0" marked="true" color="-1920102913" diameter="300" filled="true"></circle>
      <circle x="30" y="30" marked="false" color="255" diameter="240" filled="true"></circle>
    </shape>
    <shape name="cow" rotatable="false" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="200" y="193"></point>
        <point x="197" y="249"></point>
        <point x="179" y="249"></point>
        <point x="177" y="196"></point>
        <point x="166" y="187"></point>
        <point x="140" y="189"></point>
        <point x="93" y="191"></point>
        <point x="78" y="179"></point>
        <point x="72" y="211"></point>
        <point x="49" y="209"></point>
        <point x="48" y="181"></point>
        <point x="37" y="149"></point>
        <point x="25" y="120"></point>
        <point x="25" y="89"></point>
        <point x="45" y="72"></point>
        <point x="103" y="84"></point>
        <point x="179" y="75"></point>
        <point x="198" y="76"></point>
        <point x="252" y="64"></point>
        <point x="272" y="81"></point>
        <point x="293" y="103"></point>
        <point x="285" y="121"></point>
        <point x="255" y="121"></point>
        <point x="242" y="118"></point>
        <point x="224" y="167"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="73" y="210"></point>
        <point x="86" y="251"></point>
        <point x="62" y="249"></point>
        <point x="48" y="208"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="25" y="114"></point>
        <point x="16" y="195"></point>
        <point x="9" y="204"></point>
        <point x="23" y="213"></point>
        <point x="25" y="200"></point>
        <point x="39" y="123"></point>
      </polygon>
    </shape>
    <shape name="cylinder" rotatable="false" editableColorIndex="0">
      <circle x="0" y="0" marked="true" color="-1920102913" diameter="300" filled="true"></circle>
    </shape>
    <shape name="dna 1" rotatable="false" editableColorIndex="15">
      <rectangle endX="60" startY="150" marked="false" color="1504722175" endY="173" startX="0" filled="true"></rectangle>
      <rectangle endX="0" startY="196" marked="false" color="878553599" endY="176" startX="60" filled="true"></rectangle>
      <rectangle endX="298" startY="150" marked="false" color="878553599" endY="173" startX="238" filled="true"></rectangle>
      <rectangle endX="60" startY="172" marked="false" color="1422181631" endY="195" startX="0" filled="true"></rectangle>
      <rectangle endX="121" startY="150" marked="false" color="496990463" endY="173" startX="61" filled="true"></rectangle>
      <rectangle endX="121" startY="172" marked="false" color="878553599" endY="195" startX="61" filled="true"></rectangle>
      <rectangle endX="182" startY="150" marked="false" color="878553599" endY="173" startX="122" filled="true"></rectangle>
      <rectangle endX="182" startY="172" marked="false" color="496990463" endY="195" startX="122" filled="true"></rectangle>
      <rectangle endX="241" startY="172" marked="false" color="1504722175" endY="195" startX="181" filled="true"></rectangle>
      <rectangle endX="302" startY="172" marked="false" color="496990463" endY="195" startX="242" filled="true"></rectangle>
      <rectangle endX="240" startY="150" marked="false" color="1422181631" endY="173" startX="180" filled="true"></rectangle>
    </shape>
    <shape name="dna 2" rotatable="false" editableColorIndex="15">
      <rectangle endX="60" startY="150" marked="false" color="1422181631" endY="173" startX="0" filled="true"></rectangle>
      <rectangle endX="0" startY="196" marked="false" color="878553599" endY="176" startX="60" filled="true"></rectangle>
      <rectangle endX="298" startY="150" marked="false" color="878553599" endY="173" startX="238" filled="true"></rectangle>
      <rectangle endX="60" startY="172" marked="false" color="1504722175" endY="195" startX="0" filled="true"></rectangle>
      <rectangle endX="121" startY="150" marked="false" color="1422181631" endY="173" startX="61" filled="true"></rectangle>
      <rectangle endX="121" startY="172" marked="false" color="1504722175" endY="195" startX="61" filled="true"></rectangle>
      <rectangle endX="182" startY="150" marked="false" color="1504722175" endY="173" startX="122" filled="true"></rectangle>
      <rectangle endX="182" startY="172" marked="false" color="878553599" endY="195" startX="122" filled="true"></rectangle>
      <rectangle endX="241" startY="172" marked="false" color="1504722175" endY="195" startX="181" filled="true"></rectangle>
      <rectangle endX="302" startY="172" marked="false" color="496990463" endY="195" startX="242" filled="true"></rectangle>
      <rectangle endX="240" startY="150" marked="false" color="1422181631" endY="173" startX="180" filled="true"></rectangle>
    </shape>
    <shape name="dna 3" rotatable="false" editableColorIndex="15">
      <rectangle endX="300" startY="150" marked="false" color="1422181631" endY="173" startX="240" filled="true"></rectangle>
      <rectangle endX="240" startY="196" marked="false" color="878553599" endY="176" startX="300" filled="true"></rectangle>
      <rectangle endX="59" startY="150" marked="false" color="878553599" endY="173" startX="-1" filled="true"></rectangle>
      <rectangle endX="300" startY="172" marked="false" color="1504722175" endY="195" startX="240" filled="true"></rectangle>
      <rectangle endX="239" startY="150" marked="false" color="1422181631" endY="173" startX="179" filled="true"></rectangle>
      <rectangle endX="239" startY="172" marked="false" color="1504722175" endY="195" startX="179" filled="true"></rectangle>
      <rectangle endX="178" startY="150" marked="false" color="1504722175" endY="173" startX="118" filled="true"></rectangle>
      <rectangle endX="178" startY="172" marked="false" color="878553599" endY="195" startX="118" filled="true"></rectangle>
      <rectangle endX="119" startY="172" marked="false" color="1504722175" endY="195" startX="59" filled="true"></rectangle>
      <rectangle endX="58" startY="172" marked="false" color="496990463" endY="195" startX="-2" filled="true"></rectangle>
      <rectangle endX="120" startY="150" marked="false" color="1422181631" endY="173" startX="60" filled="true"></rectangle>
    </shape>
    <shape name="dna 4" rotatable="false" editableColorIndex="15">
      <rectangle endX="300" startY="150" marked="false" color="1504722175" endY="173" startX="240" filled="true"></rectangle>
      <rectangle endX="240" startY="196" marked="false" color="878553599" endY="176" startX="300" filled="true"></rectangle>
      <rectangle endX="59" startY="150" marked="false" color="878553599" endY="173" startX="-1" filled="true"></rectangle>
      <rectangle endX="300" startY="172" marked="false" color="1422181631" endY="195" startX="240" filled="true"></rectangle>
      <rectangle endX="239" startY="150" marked="false" color="496990463" endY="173" startX="179" filled="true"></rectangle>
      <rectangle endX="239" startY="172" marked="false" color="878553599" endY="195" startX="179" filled="true"></rectangle>
      <rectangle endX="178" startY="150" marked="false" color="878553599" endY="173" startX="118" filled="true"></rectangle>
      <rectangle endX="178" startY="172" marked="false" color="496990463" endY="195" startX="118" filled="true"></rectangle>
      <rectangle endX="119" startY="172" marked="false" color="1504722175" endY="195" startX="59" filled="true"></rectangle>
      <rectangle endX="58" startY="172" marked="false" color="496990463" endY="195" startX="-2" filled="true"></rectangle>
      <rectangle endX="120" startY="150" marked="false" color="1422181631" endY="173" startX="60" filled="true"></rectangle>
    </shape>
    <shape name="dot" rotatable="false" editableColorIndex="0">
      <circle x="90" y="90" marked="true" color="-1920102913" diameter="120" filled="true"></circle>
    </shape>
    <shape name="face happy" rotatable="false" editableColorIndex="0">
      <circle x="8" y="8" marked="true" color="-1920102913" diameter="285" filled="true"></circle>
      <circle x="60" y="75" marked="false" color="255" diameter="60" filled="true"></circle>
      <circle x="180" y="75" marked="false" color="255" diameter="60" filled="true"></circle>
      <polygon color="255" filled="true" marked="false">
        <point x="150" y="255"></point>
        <point x="90" y="239"></point>
        <point x="62" y="213"></point>
        <point x="47" y="191"></point>
        <point x="67" y="179"></point>
        <point x="90" y="203"></point>
        <point x="109" y="218"></point>
        <point x="150" y="225"></point>
        <point x="192" y="218"></point>
        <point x="210" y="203"></point>
        <point x="227" y="181"></point>
        <point x="251" y="194"></point>
        <point x="236" y="217"></point>
        <point x="212" y="240"></point>
      </polygon>
    </shape>
    <shape name="face neutral" rotatable="false" editableColorIndex="0">
      <circle x="8" y="7" marked="true" color="-1920102913" diameter="285" filled="true"></circle>
      <circle x="60" y="75" marked="false" color="255" diameter="60" filled="true"></circle>
      <circle x="180" y="75" marked="false" color="255" diameter="60" filled="true"></circle>
      <rectangle endX="240" startY="195" marked="false" color="255" endY="225" startX="60" filled="true"></rectangle>
    </shape>
    <shape name="face sad" rotatable="false" editableColorIndex="0">
      <circle x="8" y="8" marked="true" color="-1920102913" diameter="285" filled="true"></circle>
      <circle x="60" y="75" marked="false" color="255" diameter="60" filled="true"></circle>
      <circle x="180" y="75" marked="false" color="255" diameter="60" filled="true"></circle>
      <polygon color="255" filled="true" marked="false">
        <point x="150" y="168"></point>
        <point x="90" y="184"></point>
        <point x="62" y="210"></point>
        <point x="47" y="232"></point>
        <point x="67" y="244"></point>
        <point x="90" y="220"></point>
        <point x="109" y="205"></point>
        <point x="150" y="198"></point>
        <point x="192" y="205"></point>
        <point x="210" y="220"></point>
        <point x="227" y="242"></point>
        <point x="251" y="229"></point>
        <point x="236" y="206"></point>
        <point x="212" y="183"></point>
      </polygon>
    </shape>
    <shape name="fish" rotatable="false" editableColorIndex="0">
      <polygon color="-1" filled="true" marked="false">
        <point x="44" y="131"></point>
        <point x="21" y="87"></point>
        <point x="15" y="86"></point>
        <point x="0" y="120"></point>
        <point x="15" y="150"></point>
        <point x="0" y="180"></point>
        <point x="13" y="214"></point>
        <point x="20" y="212"></point>
        <point x="45" y="166"></point>
      </polygon>
      <polygon color="-1" filled="true" marked="false">
        <point x="135" y="195"></point>
        <point x="119" y="235"></point>
        <point x="95" y="218"></point>
        <point x="76" y="210"></point>
        <point x="46" y="204"></point>
        <point x="60" y="165"></point>
      </polygon>
      <polygon color="-1" filled="true" marked="false">
        <point x="75" y="45"></point>
        <point x="83" y="77"></point>
        <point x="71" y="103"></point>
        <point x="86" y="114"></point>
        <point x="166" y="78"></point>
        <point x="135" y="60"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="30" y="136"></point>
        <point x="151" y="77"></point>
        <point x="226" y="81"></point>
        <point x="280" y="119"></point>
        <point x="292" y="146"></point>
        <point x="292" y="160"></point>
        <point x="287" y="170"></point>
        <point x="270" y="195"></point>
        <point x="195" y="210"></point>
        <point x="151" y="212"></point>
        <point x="30" y="166"></point>
      </polygon>
      <circle x="215" y="106" marked="false" color="255" diameter="30" filled="true"></circle>
    </shape>
    <shape name="flag" rotatable="false" editableColorIndex="0">
      <rectangle endX="75" startY="15" marked="true" color="-1920102913" endY="300" startX="60" filled="true"></rectangle>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="90" y="150"></point>
        <point x="270" y="90"></point>
        <point x="90" y="30"></point>
      </polygon>
      <line endX="90" startY="135" marked="true" color="-1920102913" endY="135" startX="75"></line>
      <line endX="90" startY="45" marked="true" color="-1920102913" endY="45" startX="75"></line>
    </shape>
    <shape name="flower" rotatable="false" editableColorIndex="0">
      <polygon color="1504722175" filled="true" marked="false">
        <point x="135" y="120"></point>
        <point x="165" y="165"></point>
        <point x="180" y="210"></point>
        <point x="180" y="240"></point>
        <point x="150" y="300"></point>
        <point x="165" y="300"></point>
        <point x="195" y="240"></point>
        <point x="195" y="195"></point>
        <point x="165" y="135"></point>
      </polygon>
      <circle x="85" y="132" marked="true" color="-1920102913" diameter="38" filled="true"></circle>
      <circle x="130" y="147" marked="true" color="-1920102913" diameter="38" filled="true"></circle>
      <circle x="192" y="85" marked="true" color="-1920102913" diameter="38" filled="true"></circle>
      <circle x="85" y="40" marked="true" color="-1920102913" diameter="38" filled="true"></circle>
      <circle x="177" y="40" marked="true" color="-1920102913" diameter="38" filled="true"></circle>
      <circle x="177" y="132" marked="true" color="-1920102913" diameter="38" filled="true"></circle>
      <circle x="70" y="85" marked="true" color="-1920102913" diameter="38" filled="true"></circle>
      <circle x="130" y="25" marked="true" color="-1920102913" diameter="38" filled="true"></circle>
      <circle x="96" y="51" marked="true" color="-1920102913" diameter="108" filled="true"></circle>
      <circle x="113" y="68" marked="false" color="255" diameter="74" filled="true"></circle>
      <polygon color="1504722175" filled="true" marked="false">
        <point x="189" y="233"></point>
        <point x="219" y="188"></point>
        <point x="249" y="173"></point>
        <point x="279" y="188"></point>
        <point x="234" y="218"></point>
      </polygon>
      <polygon color="1504722175" filled="true" marked="false">
        <point x="180" y="255"></point>
        <point x="150" y="210"></point>
        <point x="105" y="210"></point>
        <point x="75" y="240"></point>
        <point x="135" y="240"></point>
      </polygon>
    </shape>
    <shape name="house" rotatable="false" editableColorIndex="0">
      <rectangle endX="255" startY="120" marked="true" color="-1920102913" endY="285" startX="45" filled="true"></rectangle>
      <rectangle endX="180" startY="210" marked="false" color="255" endY="285" startX="120" filled="true"></rectangle>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="15" y="120"></point>
        <point x="150" y="15"></point>
        <point x="285" y="120"></point>
      </polygon>
      <line endX="270" startY="120" marked="false" color="255" endY="120" startX="30"></line>
    </shape>
    <shape name="leaf" rotatable="false" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="210"></point>
        <point x="135" y="195"></point>
        <point x="120" y="210"></point>
        <point x="60" y="210"></point>
        <point x="30" y="195"></point>
        <point x="60" y="180"></point>
        <point x="60" y="165"></point>
        <point x="15" y="135"></point>
        <point x="30" y="120"></point>
        <point x="15" y="105"></point>
        <point x="40" y="104"></point>
        <point x="45" y="90"></point>
        <point x="60" y="90"></point>
        <point x="90" y="105"></point>
        <point x="105" y="120"></point>
        <point x="120" y="120"></point>
        <point x="105" y="60"></point>
        <point x="120" y="60"></point>
        <point x="135" y="30"></point>
        <point x="150" y="15"></point>
        <point x="165" y="30"></point>
        <point x="180" y="60"></point>
        <point x="195" y="60"></point>
        <point x="180" y="120"></point>
        <point x="195" y="120"></point>
        <point x="210" y="105"></point>
        <point x="240" y="90"></point>
        <point x="255" y="90"></point>
        <point x="263" y="104"></point>
        <point x="285" y="105"></point>
        <point x="270" y="120"></point>
        <point x="285" y="135"></point>
        <point x="240" y="165"></point>
        <point x="240" y="180"></point>
        <point x="270" y="195"></point>
        <point x="240" y="210"></point>
        <point x="180" y="210"></point>
        <point x="165" y="195"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="135" y="195"></point>
        <point x="135" y="240"></point>
        <point x="120" y="255"></point>
        <point x="105" y="255"></point>
        <point x="105" y="285"></point>
        <point x="135" y="285"></point>
        <point x="165" y="240"></point>
        <point x="165" y="195"></point>
      </polygon>
    </shape>
    <shape name="line" rotatable="true" editableColorIndex="0">
      <line endX="150" startY="0" marked="true" color="-1920102913" endY="300" startX="150"></line>
    </shape>
    <shape name="line half" rotatable="true" editableColorIndex="0">
      <line endX="150" startY="0" marked="true" color="-1920102913" endY="150" startX="150"></line>
    </shape>
    <shape name="mrna" rotatable="true" editableColorIndex="2">
      <circle x="219" y="114" marked="true" color="-244705793" diameter="42" filled="true"></circle>
      <circle x="189" y="129" marked="true" color="-244705793" diameter="42" filled="true"></circle>
      <circle x="159" y="114" marked="true" color="-244705793" diameter="42" filled="true"></circle>
      <circle x="39" y="114" marked="true" color="-244705793" diameter="42" filled="true"></circle>
      <circle x="69" y="129" marked="true" color="-244705793" diameter="42" filled="true"></circle>
      <circle x="98" y="144" marked="true" color="-244705793" diameter="42" filled="true"></circle>
      <circle x="129" y="129" marked="true" color="-244705793" diameter="42" filled="true"></circle>
      <circle x="99" y="145" marked="false" color="255" diameter="40" filled="false"></circle>
      <circle x="220" y="115" marked="false" color="255" diameter="40" filled="false"></circle>
      <circle x="189" y="132" marked="false" color="255" diameter="40" filled="false"></circle>
      <circle x="160" y="114" marked="false" color="255" diameter="40" filled="false"></circle>
      <circle x="129" y="131" marked="false" color="255" diameter="40" filled="false"></circle>
      <circle x="70" y="131" marked="false" color="255" diameter="40" filled="false"></circle>
      <circle x="39" y="114" marked="false" color="255" diameter="40" filled="false"></circle>
    </shape>
    <shape name="pentagon" rotatable="false" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="15"></point>
        <point x="15" y="120"></point>
        <point x="60" y="285"></point>
        <point x="240" y="285"></point>
        <point x="285" y="120"></point>
      </polygon>
    </shape>
    <shape name="person" rotatable="false" editableColorIndex="0">
      <circle x="110" y="5" marked="true" color="-1920102913" diameter="80" filled="true"></circle>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="105" y="90"></point>
        <point x="120" y="195"></point>
        <point x="90" y="285"></point>
        <point x="105" y="300"></point>
        <point x="135" y="300"></point>
        <point x="150" y="225"></point>
        <point x="165" y="300"></point>
        <point x="195" y="300"></point>
        <point x="210" y="285"></point>
        <point x="180" y="195"></point>
        <point x="195" y="90"></point>
      </polygon>
      <rectangle endX="172" startY="79" marked="true" color="-1920102913" endY="94" startX="127" filled="true"></rectangle>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="195" y="90"></point>
        <point x="240" y="150"></point>
        <point x="225" y="180"></point>
        <point x="165" y="105"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="105" y="90"></point>
        <point x="60" y="150"></point>
        <point x="75" y="180"></point>
        <point x="135" y="105"></point>
      </polygon>
    </shape>
    <shape name="plant" rotatable="false" editableColorIndex="0">
      <rectangle endX="165" startY="90" marked="true" color="-1920102913" endY="300" startX="135" filled="true"></rectangle>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="135" y="255"></point>
        <point x="90" y="210"></point>
        <point x="45" y="195"></point>
        <point x="75" y="255"></point>
        <point x="135" y="285"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="165" y="255"></point>
        <point x="210" y="210"></point>
        <point x="255" y="195"></point>
        <point x="225" y="255"></point>
        <point x="165" y="285"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="135" y="180"></point>
        <point x="90" y="135"></point>
        <point x="45" y="120"></point>
        <point x="75" y="180"></point>
        <point x="135" y="210"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="165" y="180"></point>
        <point x="165" y="210"></point>
        <point x="225" y="180"></point>
        <point x="255" y="120"></point>
        <point x="210" y="135"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="135" y="105"></point>
        <point x="90" y="60"></point>
        <point x="45" y="45"></point>
        <point x="75" y="105"></point>
        <point x="135" y="135"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="165" y="105"></point>
        <point x="165" y="135"></point>
        <point x="225" y="105"></point>
        <point x="255" y="45"></point>
        <point x="210" y="60"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="135" y="90"></point>
        <point x="120" y="45"></point>
        <point x="150" y="15"></point>
        <point x="180" y="45"></point>
        <point x="165" y="90"></point>
      </polygon>
    </shape>
    <shape name="sheep" rotatable="false" editableColorIndex="15">
      <circle x="203" y="65" marked="true" color="-1" diameter="88" filled="true"></circle>
      <circle x="70" y="65" marked="true" color="-1" diameter="162" filled="true"></circle>
      <circle x="150" y="105" marked="true" color="-1" diameter="120" filled="true"></circle>
      <polygon color="-1920102913" filled="true" marked="false">
        <point x="218" y="120"></point>
        <point x="240" y="165"></point>
        <point x="255" y="165"></point>
        <point x="278" y="120"></point>
      </polygon>
      <circle x="214" y="72" marked="false" color="-1920102913" diameter="67" filled="true"></circle>
      <rectangle endX="179" startY="223" marked="true" color="-1" endY="298" startX="164" filled="true"></rectangle>
      <polygon color="-1" filled="true" marked="true">
        <point x="45" y="285"></point>
        <point x="30" y="285"></point>
        <point x="30" y="240"></point>
        <point x="15" y="195"></point>
        <point x="45" y="210"></point>
      </polygon>
      <circle x="3" y="83" marked="true" color="-1" diameter="150" filled="true"></circle>
      <rectangle endX="80" startY="221" marked="true" color="-1" endY="296" startX="65" filled="true"></rectangle>
      <polygon color="-1" filled="true" marked="true">
        <point x="195" y="285"></point>
        <point x="210" y="285"></point>
        <point x="210" y="240"></point>
        <point x="240" y="210"></point>
        <point x="195" y="210"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="false">
        <point x="276" y="85"></point>
        <point x="285" y="105"></point>
        <point x="302" y="99"></point>
        <point x="294" y="83"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="false">
        <point x="219" y="85"></point>
        <point x="210" y="105"></point>
        <point x="193" y="99"></point>
        <point x="201" y="83"></point>
      </polygon>
    </shape>
    <shape name="signal" rotatable="false" editableColorIndex="6">
      <circle x="30" y="60" marked="true" color="751909887" diameter="240" filled="true"></circle>
      <rectangle endX="180" startY="150" marked="true" color="751909887" endY="180" startX="120" filled="true"></rectangle>
      <rectangle endX="270" startY="45" marked="false" color="496990463" endY="150" startX="30" filled="true"></rectangle>
      <rectangle endX="120" startY="150" marked="false" color="496990463" endY="180" startX="75" filled="true"></rectangle>
      <rectangle endX="225" startY="150" marked="false" color="496990463" endY="180" startX="180" filled="true"></rectangle>
    </shape>
    <shape name="square" rotatable="false" editableColorIndex="0">
      <rectangle endX="270" startY="30" marked="true" color="-1920102913" endY="270" startX="30" filled="true"></rectangle>
    </shape>
    <shape name="square 2" rotatable="false" editableColorIndex="0">
      <rectangle endX="270" startY="30" marked="true" color="-1920102913" endY="270" startX="30" filled="true"></rectangle>
      <rectangle endX="240" startY="60" marked="false" color="255" endY="240" startX="60" filled="true"></rectangle>
    </shape>
    <shape name="star" rotatable="false" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="151" y="1"></point>
        <point x="185" y="108"></point>
        <point x="298" y="108"></point>
        <point x="207" y="175"></point>
        <point x="242" y="282"></point>
        <point x="151" y="216"></point>
        <point x="59" y="282"></point>
        <point x="94" y="175"></point>
        <point x="3" y="108"></point>
        <point x="116" y="108"></point>
      </polygon>
    </shape>
    <shape name="target" rotatable="false" editableColorIndex="0">
      <circle x="0" y="0" marked="true" color="-1920102913" diameter="300" filled="true"></circle>
      <circle x="30" y="30" marked="false" color="255" diameter="240" filled="true"></circle>
      <circle x="60" y="60" marked="true" color="-1920102913" diameter="180" filled="true"></circle>
      <circle x="90" y="90" marked="false" color="255" diameter="120" filled="true"></circle>
      <circle x="120" y="120" marked="true" color="-1920102913" diameter="60" filled="true"></circle>
    </shape>
    <shape name="transcription factor" rotatable="true" editableColorIndex="8">
      <rectangle endX="120" startY="150" marked="true" color="1422181631" endY="180" startX="75" filled="true"></rectangle>
      <rectangle endX="225" startY="150" marked="true" color="1422181631" endY="180" startX="180" filled="true"></rectangle>
      <rectangle endX="225" startY="105" marked="true" color="1422181631" endY="150" startX="75" filled="true"></rectangle>
      <circle x="88" y="13" marked="true" color="1422181631" diameter="124" filled="true"></circle>
      <rectangle endX="120" startY="165" marked="false" color="255" endY="180" startX="75" filled="true"></rectangle>
      <rectangle endX="225" startY="165" marked="false" color="255" endY="180" startX="180" filled="true"></rectangle>
    </shape>
    <shape name="transcription factor bound" rotatable="true" editableColorIndex="8">
      <rectangle endX="120" startY="150" marked="false" color="255" endY="180" startX="75" filled="true"></rectangle>
      <rectangle endX="225" startY="150" marked="false" color="255" endY="180" startX="180" filled="true"></rectangle>
      <circle x="105" y="60" marked="true" color="1422181631" diameter="90" filled="true"></circle>
      <rectangle endX="225" startY="120" marked="true" color="1422181631" endY="150" startX="75" filled="true"></rectangle>
    </shape>
    <shape name="transcription factor signal bound" rotatable="false" editableColorIndex="8">
      <rectangle endX="120" startY="150" marked="false" color="255" endY="180" startX="75" filled="true"></rectangle>
      <rectangle endX="225" startY="150" marked="false" color="255" endY="180" startX="180" filled="true"></rectangle>
      <rectangle endX="210" startY="105" marked="true" color="1422181631" endY="150" startX="90" filled="true"></rectangle>
      <circle x="129" y="84" marked="true" color="1422181631" diameter="42" filled="true"></circle>
    </shape>
    <shape name="tree" rotatable="false" editableColorIndex="0">
      <circle x="118" y="3" marked="true" color="-1920102913" diameter="94" filled="true"></circle>
      <rectangle endX="180" startY="195" marked="false" color="-1653716737" endY="300" startX="120" filled="true"></rectangle>
      <circle x="65" y="21" marked="true" color="-1920102913" diameter="108" filled="true"></circle>
      <circle x="116" y="41" marked="true" color="-1920102913" diameter="127" filled="true"></circle>
      <circle x="45" y="90" marked="true" color="-1920102913" diameter="120" filled="true"></circle>
      <circle x="104" y="74" marked="true" color="-1920102913" diameter="152" filled="true"></circle>
    </shape>
    <shape name="triangle" rotatable="false" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="30"></point>
        <point x="15" y="255"></point>
        <point x="285" y="255"></point>
      </polygon>
    </shape>
    <shape name="triangle 2" rotatable="false" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="150" y="30"></point>
        <point x="15" y="255"></point>
        <point x="285" y="255"></point>
      </polygon>
      <polygon color="255" filled="true" marked="false">
        <point x="151" y="99"></point>
        <point x="225" y="223"></point>
        <point x="75" y="224"></point>
      </polygon>
    </shape>
    <shape name="truck" rotatable="false" editableColorIndex="0">
      <rectangle endX="195" startY="45" marked="true" color="-1920102913" endY="187" startX="4" filled="true"></rectangle>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="296" y="193"></point>
        <point x="296" y="150"></point>
        <point x="259" y="134"></point>
        <point x="244" y="104"></point>
        <point x="208" y="104"></point>
        <point x="207" y="194"></point>
      </polygon>
      <rectangle endX="195" startY="60" marked="false" color="-1" endY="105" startX="195" filled="true"></rectangle>
      <polygon color="255" filled="true" marked="false">
        <point x="238" y="112"></point>
        <point x="252" y="141"></point>
        <point x="219" y="141"></point>
        <point x="218" y="112"></point>
      </polygon>
      <circle x="234" y="174" marked="false" color="255" diameter="42" filled="true"></circle>
      <rectangle endX="214" startY="185" marked="true" color="-1920102913" endY="194" startX="181" filled="true"></rectangle>
      <circle x="144" y="174" marked="false" color="255" diameter="42" filled="true"></circle>
      <circle x="24" y="174" marked="false" color="255" diameter="42" filled="true"></circle>
      <circle x="24" y="174" marked="true" color="-1920102913" diameter="42" filled="false"></circle>
      <circle x="144" y="174" marked="true" color="-1920102913" diameter="42" filled="false"></circle>
      <circle x="234" y="174" marked="true" color="-1920102913" diameter="42" filled="false"></circle>
    </shape>
    <shape name="turtle" rotatable="true" editableColorIndex="0">
      <polygon color="1504722175" filled="true" marked="false">
        <point x="215" y="204"></point>
        <point x="240" y="233"></point>
        <point x="246" y="254"></point>
        <point x="228" y="266"></point>
        <point x="215" y="252"></point>
        <point x="193" y="210"></point>
      </polygon>
      <polygon color="1504722175" filled="true" marked="false">
        <point x="195" y="90"></point>
        <point x="225" y="75"></point>
        <point x="245" y="75"></point>
        <point x="260" y="89"></point>
        <point x="269" y="108"></point>
        <point x="261" y="124"></point>
        <point x="240" y="105"></point>
        <point x="225" y="105"></point>
        <point x="210" y="105"></point>
      </polygon>
      <polygon color="1504722175" filled="true" marked="false">
        <point x="105" y="90"></point>
        <point x="75" y="75"></point>
        <point x="55" y="75"></point>
        <point x="40" y="89"></point>
        <point x="31" y="108"></point>
        <point x="39" y="124"></point>
        <point x="60" y="105"></point>
        <point x="75" y="105"></point>
        <point x="90" y="105"></point>
      </polygon>
      <polygon color="1504722175" filled="true" marked="false">
        <point x="132" y="85"></point>
        <point x="134" y="64"></point>
        <point x="107" y="51"></point>
        <point x="108" y="17"></point>
        <point x="150" y="2"></point>
        <point x="192" y="18"></point>
        <point x="192" y="52"></point>
        <point x="169" y="65"></point>
        <point x="172" y="87"></point>
      </polygon>
      <polygon color="1504722175" filled="true" marked="false">
        <point x="85" y="204"></point>
        <point x="60" y="233"></point>
        <point x="54" y="254"></point>
        <point x="72" y="266"></point>
        <point x="85" y="252"></point>
        <point x="107" y="210"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="119" y="75"></point>
        <point x="179" y="75"></point>
        <point x="209" y="101"></point>
        <point x="224" y="135"></point>
        <point x="220" y="225"></point>
        <point x="175" y="261"></point>
        <point x="128" y="261"></point>
        <point x="81" y="224"></point>
        <point x="74" y="135"></point>
        <point x="88" y="99"></point>
      </polygon>
    </shape>
    <shape name="wheel" rotatable="false" editableColorIndex="0">
      <circle x="3" y="3" marked="true" color="-1920102913" diameter="294" filled="true"></circle>
      <circle x="30" y="30" marked="false" color="255" diameter="240" filled="true"></circle>
      <line endX="150" startY="285" marked="true" color="-1920102913" endY="15" startX="150"></line>
      <line endX="285" startY="150" marked="true" color="-1920102913" endY="150" startX="15"></line>
      <circle x="120" y="120" marked="true" color="-1920102913" diameter="60" filled="true"></circle>
      <line endX="79" startY="40" marked="true" color="-1920102913" endY="269" startX="216"></line>
      <line endX="269" startY="84" marked="true" color="-1920102913" endY="221" startX="40"></line>
      <line endX="269" startY="216" marked="true" color="-1920102913" endY="79" startX="40"></line>
      <line endX="221" startY="40" marked="true" color="-1920102913" endY="269" startX="84"></line>
    </shape>
    <shape name="wolf" rotatable="false" editableColorIndex="0">
      <polygon color="255" filled="true" marked="false">
        <point x="253" y="133"></point>
        <point x="245" y="131"></point>
        <point x="245" y="133"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="2" y="194"></point>
        <point x="13" y="197"></point>
        <point x="30" y="191"></point>
        <point x="38" y="193"></point>
        <point x="38" y="205"></point>
        <point x="20" y="226"></point>
        <point x="20" y="257"></point>
        <point x="27" y="265"></point>
        <point x="38" y="266"></point>
        <point x="40" y="260"></point>
        <point x="31" y="253"></point>
        <point x="31" y="230"></point>
        <point x="60" y="206"></point>
        <point x="68" y="198"></point>
        <point x="75" y="209"></point>
        <point x="66" y="228"></point>
        <point x="65" y="243"></point>
        <point x="82" y="261"></point>
        <point x="84" y="268"></point>
        <point x="100" y="267"></point>
        <point x="103" y="261"></point>
        <point x="77" y="239"></point>
        <point x="79" y="231"></point>
        <point x="100" y="207"></point>
        <point x="98" y="196"></point>
        <point x="119" y="201"></point>
        <point x="143" y="202"></point>
        <point x="160" y="195"></point>
        <point x="166" y="210"></point>
        <point x="172" y="213"></point>
        <point x="173" y="238"></point>
        <point x="167" y="251"></point>
        <point x="160" y="248"></point>
        <point x="154" y="265"></point>
        <point x="169" y="264"></point>
        <point x="178" y="247"></point>
        <point x="186" y="240"></point>
        <point x="198" y="260"></point>
        <point x="200" y="271"></point>
        <point x="217" y="271"></point>
        <point x="219" y="262"></point>
        <point x="207" y="258"></point>
        <point x="195" y="230"></point>
        <point x="192" y="198"></point>
        <point x="210" y="184"></point>
        <point x="227" y="164"></point>
        <point x="242" y="144"></point>
        <point x="259" y="145"></point>
        <point x="284" y="151"></point>
        <point x="277" y="141"></point>
        <point x="293" y="140"></point>
        <point x="299" y="134"></point>
        <point x="297" y="127"></point>
        <point x="273" y="119"></point>
        <point x="270" y="105"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="-1" y="195"></point>
        <point x="14" y="180"></point>
        <point x="36" y="166"></point>
        <point x="40" y="153"></point>
        <point x="53" y="140"></point>
        <point x="82" y="131"></point>
        <point x="134" y="133"></point>
        <point x="159" y="126"></point>
        <point x="188" y="115"></point>
        <point x="227" y="108"></point>
        <point x="236" y="102"></point>
        <point x="238" y="98"></point>
        <point x="268" y="86"></point>
        <point x="269" y="92"></point>
        <point x="281" y="87"></point>
        <point x="269" y="103"></point>
        <point x="269" y="113"></point>
      </polygon>
    </shape>
    <shape name="x" rotatable="false" editableColorIndex="0">
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="270" y="75"></point>
        <point x="225" y="30"></point>
        <point x="30" y="225"></point>
        <point x="75" y="270"></point>
      </polygon>
      <polygon color="-1920102913" filled="true" marked="true">
        <point x="30" y="75"></point>
        <point x="75" y="30"></point>
        <point x="270" y="225"></point>
        <point x="225" y="270"></point>
      </polygon>
    </shape>
  </turtleShapes>
  <linkShapes>
    <shape name="default" curviness="0.0">
      <lines>
        <line x="-0.2" visible="false">
          <dash value="0.0"></dash>
          <dash value="1.0"></dash>
        </line>
        <line x="0.0" visible="true">
          <dash value="1.0"></dash>
          <dash value="0.0"></dash>
        </line>
        <line x="0.2" visible="false">
          <dash value="0.0"></dash>
          <dash value="1.0"></dash>
        </line>
      </lines>
      <indicator>
        <shape name="link direction" rotatable="true" editableColorIndex="0">
          <line endX="90" startY="150" marked="true" color="-1920102913" endY="180" startX="150"></line>
          <line endX="210" startY="150" marked="true" color="-1920102913" endY="180" startX="150"></line>
        </shape>
      </indicator>
    </shape>
  </linkShapes>
  <previewCommands>setup repeat 75 [ go ]</previewCommands>
  <experiments>
    <experiment name="repr 1" repetitions="3" sequentialRunOrder="true" runMetricsEveryStep="false" timeLimit="10000">
      <setup>setup</setup>
      <go>go</go>
      <metrics>
        <metric>on-off-harmonic-mean</metric>
        <metric>mean-off-duration</metric>
        <metric>mean-on-duration</metric>
      </metrics>
      <constants>
        <steppedValueSet variable="signal-decay-prob" first="0.05" step="0.1" last="0.95"></steppedValueSet>
        <steppedValueSet variable="signal-TF-bind-prob" first="0.05" step="0.1" last="0.95"></steppedValueSet>
      </constants>
    </experiment>
    <experiment name="TF-mRNA-experiment" repetitions="1" sequentialRunOrder="true" runMetricsEveryStep="false" timeLimit="10000">
      <setup>setup</setup>
      <go>go</go>
      <metrics>
        <metric>on-off-harmonic-mean</metric>
        <metric>mean-off-duration</metric>
        <metric>mean-on-duration</metric>
      </metrics>
      <constants>
        <steppedValueSet variable="TF-bind-prob" first="0.05" step="0.1" last="0.95"></steppedValueSet>
        <steppedValueSet variable="mRNA-decay-prob" first="0.05" step="0.1" last="0.95"></steppedValueSet>
        <steppedValueSet variable="TF-decay-prob" first="0.05" step="0.1" last="0.95"></steppedValueSet>
        <steppedValueSet variable="TF-unbind-prob" first="0.05" step="0.1" last="0.95"></steppedValueSet>
      </constants>
    </experiment>
  </experiments>
</model>
